<!DOCTYPE html>
<html>
<head>
  <link rel="stylesheet" href="css/style.css">
<link rel="stylesheet" href="css/style2.css">
<link rel="stylesheet" href="css/suna.css">
<script type="text/javascript">

  //window.onload = function() {
   // var a = document.getElementById("mylink");
    //a.onclick = function() {
      //  return false;
   // }
  //}
</script>
</head>
<body>

<div class="header">
  <h1>Burtu spēle</h1>
  <p>Lieliska spēle, lieliskiem panākumiem</p>
</div>

<div class="topnav">
    <a href="index.html"><img class="img_bite_sm" src="img/bite1.gif">sākums</a>
    <a href="#" id="mylink2" onclick="sunuAizversana()"><img class="img_bite_sm" src="img/bite1.gif">sākt spēli</a>
    <a href="top.html"><img class="img_bite_sm" src="img/bite2.gif">rezultātu tops</a>
    <a href="help.html"><img class="img_bite_sm" src="img/bite3.gif">pamācība</a>
    <a href="login.html"><img class="img_bite_sm" src="img/bite4.gif">reģistrēties</a>
</div>

<div class="row">
  <div class="leftcolumn">
    <div class="card"><a href="#" id="mylink1" onclick="jaunsVards();">
        <div class="sunuLauks">
            <div class="container">
                <div class="suna"></div>
                <div class="suna"></div>
                <div class="suna"></div>
                <div class="suna"></div>
                <div class="suna"></div>
                <div class="suna"></div>
                <div class="suna"></div>
                <div class="suna"></div>
                <div class="suna"></div>
                <div class="suna"></div>
                <div class="suna"></div>
                <div class="suna"></div>
                <div class="suna"></div>
                <div class="suna"></div>
                <div class="suna"></div>
                <div class="suna"></div>
                <div class="suna"></div>
                <div class="suna"></div>
                <div class="suna"></div>
                <div class="suna"></div>
                <div class="suna"></div>
                <div class="suna"></div>
            </div>
        </div></a>
        <div class="spelesLauks">
          <div class="container2">
            
          </div>  
        </div> 
    </div>

    
  </div>
  <div class="rightcolumn">
    <div class="card">
      <h2>Tavi sasniegumi</h2>
      <div class="score"></div>

    </div>
    <div class="card">
      <h3>Rezutatīvākie spēlētāji</h3>
      <div><p>Uzvarētājs 1</p></div>
      <div><p>Uzvarētājs 2</p></div>
      <div><p>Uzvarētājs 3</p></div>
    </div>
    <div class="card">
      <h3>Follow Me</h3>
      <p>Some text..</p>
    </div>
  </div>
</div>

<div class="footer">
  <h2>Nāc rīt atkal spēlēt un uzvarēt... <div class=""></div></h2>
</div>



<script>
  const spelesLauks = document.querySelector('.spelesLauks');
  const sunuLauks = document.querySelector('.sunuLauks');
  const suna = document.querySelector('.suna');
  const btn = document.createElement('button');
  const ievadamieBurti = document.createElement('input');
  const rezultatuTablo = document.querySelector('.score');
  const burtuLauks = document.querySelector('.container2');
  const dzesamaisLauks = document.createElement('div') 
  var atveramieBurti=0;
  ievadamieBurti.setAttribute('type','text');
  ievadamieBurti.classList.add('tekstaIevade');
  btn.textContent = "SĀKT SPĒLI!";
  spelesLauks.append(ievadamieBurti);
  spelesLauks.append(btn);

  const spelesVardi = [];
  const spele ={izveletaisVards:'', sajauktsVards:'',rezultats:0, nepareizi:0, atlikusieVardi:0, izspeles:spelesVardi.length};
  
 // ielasa vārdus no google sheets - https://docs.google.com/spreadsheets/d/1ilaxRabk_2VQPtNBkh9qzPYhp5lDCV4mq7YQEmUz-io/edit?usp=sharing 
const url ='https://docs.google.com/spreadsheets/d/';
const ssid = '1ilaxRabk_2VQPtNBkh9qzPYhp5lDCV4mq7YQEmUz-io';
const query1 =`/gviz/tq?`;
const endpoint1 = `${url}${ssid}${query1}`;

fetch(endpoint1)
.then(res=>res.text())
.then(data => {
    const temp = data.substring(47).slice(0,-2);
    const json = JSON.parse(temp);
    const rows = json.table.rows;
    rows.forEach((row) => {
    const temp1 = (row.c);
    const div = document.createElement('div');
      temp1.forEach((cell)=>{
          spelesVardi.push(cell.v);
      })    
    });
}) //beidzas vārdu ielasīšana masīvā no google

  rezultatuTablo.style.display="none";
  ievadamieBurti.style.display = 'none';
  btn.style.display = 'none';    
  

   //lai uzsāktu spēli bez atsevišķas pogas, vnk uzspiežot uz šūnām
  btn.addEventListener('click',(e)=>{
      sunuAizversana();   
      });

  function sunuAizversana(){
    x=atveramieBurti;
    for (var y = 0; y < x; y++) {
      document.getElementById("burts"+y).remove();
      atveramieBurti=0;
    }
    jaunsVards();
  }

  function jaunsVards(){
    sunuLauks.style.display = "none";
    if(spelesVardi.length<=0){
        spelesLauks.innerHTML="<div>Spēles beigas</div>"
        spelesLauks.innerHTML+=`Tu ieguvi ${spele.rezultats}, kļūdījies ${spele.nepareizi}!`;
    }else{
    ievadamieBurti.disabled = false;
    ievadamieBurti.value='';
    ievadamieBurti.style.borderWidth='1px';
    ievadamieBurti.style.borderColor="#eee";
    rezultatuTablo.style.display="block";
    ievadamieBurti.style.display = 'inline';
    btn.style.display = 'none';
    ievadamieBurti.focus();
    spelesVardi.sort(()=>{return 0.5 - Math.random()});
    spele.izveletaisVards= spelesVardi.shift();
    console.log(spelesVardi);
    spele.atlikusieVardi = spelesVardi.length;
    spele.sajauktsVards = burtuJauksana(spele.izveletaisVards);
    
    pievienotRezultatu();
    ievadamieBurti.setAttribute('maxlength', spele.izveletaisVards.length);
    spele.atlikusieVardi=spelesVardi.length;
    }
  }

  ievadamieBurti.addEventListener('keyup', (e)=>{
      ievadamieBurti.style.borderColor = '#eee';
      ievadamieBurti.style.borderWidth = '1px';
      if (ievadamieBurti.value.length == spele.izveletaisVards.length || e.code == 'Enter'){
          vardaParbaude();
      }
  })

  function pievienotRezultatu(){
      let pagaiduIzvade = `Rezultāts: ${spele.rezultats}. Kļūdainie mēģinājumi ${spele.nepareizi}`;
      rezultatuTablo.innerHTML = pagaiduIzvade;
  }

  function vardaParbaude(){
      ievadamieBurti.style.borderWidth='5px';
      if(ievadamieBurti.value == spele.izveletaisVards){
          ievadamieBurti.style.borderColor='green';
          spele.rezultats++;
          ievadamieBurti.disabled = true;
          btn.style.display='block';
          btn.textContent = 'Nākamais vārds';
         btn.focus();
         
      }else{
          ievadamieBurti.style.borderColor = 'red';
          ievadamieBurti.value = '';
          ievadamieBurti.focus();
          spele.nepareizi++;
      }
      pievienotRezultatu();
  }

  function burtuJauksana(orginalvards){
      let jauktsVards = orginalvards.split('');
      jauktsVards.sort(()=>{return 0.5 - Math.random()});  
      jauktsVards=jauktsVards.join('');
      if (orginalvards == jauktsVards){
          return burtuJauksana(orginalvards)
      }
      var b = jauktsVards; 
      var izmestieBurti=[]; 
      for (var z = 0; z < b.length; z++) {
          izmestieBurti.push(b.charAt(z)) 
          
          const burts = document.createElement('div');
          const burtaIeraksts = document.createElement('div');
          
          burtuLauks.append(burts);
          burts.append(burtaIeraksts);

          burtaIeraksts.classList.add('burtaLauks');
          burtaIeraksts.setAttribute('id','burtaIeraksts'+z);

          burts.classList.add('suna');
          
          burts.setAttribute('id','burts'+z);
          
          burtaIeraksts.textContent=(b.charAt(z));

          atveramieBurti++;
          
      }
      return jauktsVards; 
  }


  </script>
</body>
</html>
